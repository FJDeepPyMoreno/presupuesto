<!-- FIXME: Temporary solution until we bring in the viz code from Observable -->

<center>

  <div id="observablehq-chart-0c28eab6"></div>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css">
  <script type="module">
    import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";
    import define from "https://api.observablehq.com/@carmen-tm/objetivos-madrid_v01.js?v=3";
    const main = new Runtime().module(define, name => {
      if (name === "chart") return new Inspector(document.querySelector("#observablehq-chart-0c28eab6"));
      return ["watcher","arc","arc2","auxArcFactor","auxArcPixels","colorPrimary","onMouseOver"].includes(name);
    });

    // index_script.html START

    function onYearChange() {
      // $('#investments-viz').trigger('year-change', getUIState().year);
      // console.log("AÃ±o cambiado: "+getUIState().year);
      main.redefine("yearSelector", +getUIState().year);
    }

    // Setup year navigation
    // FIXME: hardcoded years
    var years = ["2017", "2018", "2019", "2020", "2021", "2022"];
    initSlider("#year-selection", years, 2021);
    setRedrawOnSliderChange("#year-selection", 2021, onYearChange);

    // Add click embed btn event
    setEmbedModal();

    // index_script.html END

    // Temporary way of changing the viz year, 
    // just need to redefine the year selector cell as follow:
    main.redefine("yearSelector", +getUIState().year);
    
  </script>

</center>